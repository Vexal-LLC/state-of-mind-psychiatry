---
import { Icon } from "astro-icon/components";
import FullWidthContainer from "../components/FullWidthContainer.astro";
import "swiper/css";
import "swiper/css/pagination";
import { Image } from "astro:assets";

const services = [
  {
    title: "Attention Deficit Hyperactivity Disorder",
    description: "ADHD is a common mental health condition that affects how you pay attention, sit still, and control your behavior.",
    image: "https://images.unsplash.com/photo-1595552900947-11d59614541d?q=80&w=2574&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
  {
    title: "Stress and Anxiety",
    description: "Stress and Anxiety are common mental health issues that can affect anyone at any age.",
    image: "https://plus.unsplash.com/premium_photo-1689177357589-fb06fc00da07?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
  {
    title: "Mood Disorders",
    description: "Mood disorders are mental health conditions that affect your mood and emotional well-being.",
    image: "https://images.unsplash.com/photo-1611858977757-8f7cdc084d3b?q=80&w=2574&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
  {
    title: "Post-Traumatic Stress Disorder",
    description: "PTSD is a mental health condition that can develop after a traumatic event.",
    image: "https://plus.unsplash.com/premium_photo-1661301178605-21949cf82eb9?q=80&w=2669&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
  {
    title: "Bipolar Disorder",
    description: "Bipolar disorder is a mental health condition that causes extreme mood swings that can affect your ability to function.",
    image: "https://plus.unsplash.com/premium_photo-1666299237090-a380aa4f71bf?q=80&w=2574&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
  },
];
---

<FullWidthContainer class="bg-primary text-white py-16">
  <div
    class="flex flex-col md:flex-row gap-12 items-center max-w-7xl mx-auto px-4"
  >
    <!-- Left Content -->
    <div class="space-y-6 md:w-2/3">
      <div
        class="group relative rounded-full px-4 py-1.5 font-sans text-sm leading-6 text-white ring-1 ring-primary-light tracking-tight inline-block uppercase"
      >
        We care for you
      </div>

      <h1
        class="text-4xl md:text-5xl font-medium leading-tight font-serif pb-4"
      >
        We help you to
        <span class="relative">
          <span class="text-yellow-400 relative inline-block z-10">
            grow
            <span
              class="absolute bottom-0 left-0 h-[8px] rounded-[2px] w-full bg-accent-orange -z-10"
            ></span>
          </span>
          {" "}
          <span class="text-yellow-400 relative inline-block z-10">
            confidence
            <span
              class="absolute bottom-0 left-0 h-[8px] rounded-[2px] w-full bg-accent-orange -z-10"
            ></span>
          </span>
        </span>
        <br />at any age
      </h1>

      <p class="text-xl">
        We offer a wide range of services to help you manage your mental health
        effectively.
      </p>
    </div>

    <!-- Desktop carousel -->
    <div class="hidden md:flex gap-8 items-center md:w-1/3 h-[500px]">
      <!-- Vertical pagination -->
      <div class="flex flex-col gap-4">
        {
          services.map((_, index) => (
            <button
              class={`pagination-bullet-vertical w-2 h-16 rounded-full bg-white/20 hover:bg-white/80 transition-all duration-300 ${index === 0 ? "active" : ""}`}
              data-index={index}
              style="min-width: 8px;"
            />
          ))
        }
      </div>

      <!-- Vertical Swiper -->
      <div class="relative overflow-hidden rounded-2xl w-full h-full">
        <div class="swiper services-swiper-vertical h-full">
          <div class="swiper-wrapper">
            {
              services.map((service) => (
                <div class="swiper-slide h-full">
                  <div class="bg-white rounded-xl overflow-hidden shadow-lg h-full flex flex-col">
                    <!-- Image container -->
                    <div class="relative flex-1 min-h-0">
                        <Image
                            src={service.image}
                            alt={`${service.title} illustration`}
                            class="absolute inset-0 w-full h-full object-cover"
                            width={800}
                            height={600}
                        />
                    </div>

                    <!-- Content container -->
                    <div class="flex-none p-6 space-y-4">
                      <h3 class="text-xl font-semibold text-gray-800 border-b-2 border-t-2 border-secondary/50 py-3">
                        {service.title}
                      </h3>
                      <p class="text-gray-600">
                        {service.description}
                      </p>
                    </div>
                  </div>
                </div>
              ))
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Mobile carousel - adjust width and padding -->
    <div class="md:hidden w-full">
      <div class="relative h-[500px]">
        <div class="swiper services-swiper-horizontal h-full">
          <div class="swiper-wrapper">
            {
              services.map((service) => (
                <div class="swiper-slide">
                  <div class="bg-white rounded-xl overflow-hidden shadow-lg h-full flex flex-col">
                    <!-- Image container -->
                    <div class="relative flex-1 min-h-0">
                      <img
                        src={service.image}
                        alt={`${service.title} illustration`}
                        class="absolute inset-0 w-full h-full object-cover"
                      />
                    </div>

                    <!-- Content container -->
                    <div class="flex-none p-6 space-y-4">
                      <h3 class="text-xl font-semibold text-gray-800 border-b-2 border-t-2 border-secondary/50 py-3">
                        {service.title}
                      </h3>
                      <p class="text-gray-600">
                        {service.description}
                      </p>
                    </div>
                  </div>
                </div>
              ))
            }
          </div>
        </div>
        <!-- Custom horizontal pagination -->
        <div class="flex justify-center gap-4 mt-6">
          {
            services.map((_, index) => (
              <button
                class={`pagination-bullet-horizontal w-8 h-2 rounded-full bg-white/20 hover:bg-white/80 transition-all duration-300 ${
                  index === 0 ? "active" : ""
                }`}
                data-index={index}
              />
            ))
          }
        </div>
      </div>
    </div>
  </div>
</FullWidthContainer>

<script>
  import Swiper from "swiper";
  import { Mousewheel } from "swiper/modules";

  document.addEventListener("DOMContentLoaded", () => {
    // Update vertical swiper
    const swiperVertical = new Swiper(".services-swiper-vertical", {
      modules: [Mousewheel],
      direction: "vertical",
      slidesPerView: 1,
      spaceBetween: 30,
      mousewheel: true,
      initialSlide: 0,
    });

    // Update horizontal swiper
    const swiperHorizontal = new Swiper(".services-swiper-horizontal", {
      direction: "horizontal",
      slidesPerView: 1,
      spaceBetween: 30,
      initialSlide: 0,
      centeredSlides: true,
      loop: true,
      grabCursor: true,
    });

    // Vertical pagination
    const verticalBullets = document.querySelectorAll(
      ".pagination-bullet-vertical"
    );
    verticalBullets.forEach((bullet) => {
      bullet.addEventListener("click", () => {
        const index = parseInt(bullet.getAttribute("data-index"));
        swiperVertical.slideTo(index);
      });
    });

    swiperVertical.on("slideChange", () => {
      verticalBullets.forEach((bullet, index) => {
        bullet.classList.toggle("active", index === swiperVertical.activeIndex);
      });
    });

    // Custom horizontal pagination logic
    const horizontalBullets = document.querySelectorAll(
      ".pagination-bullet-horizontal"
    );

    horizontalBullets.forEach((bullet) => {
      bullet.addEventListener("click", () => {
        const index = parseInt(bullet.getAttribute("data-index"));
        swiperHorizontal.slideTo(index);
      });
    });

    swiperHorizontal.on("slideChange", () => {
      horizontalBullets.forEach((bullet, index) => {
        bullet.classList.toggle("active", index === swiperHorizontal.realIndex);
      });
    });
  });
</script>

<style>
  .pagination-bullet-vertical,
  .pagination-bullet-horizontal {
    display: block !important;
    position: relative !important;
  }
  .pagination-bullet-vertical.active,
  .pagination-bullet-horizontal.active {
    opacity: 1 !important;
    background-color: rgb(255 255 255 / 0.8) !important;
  }

  .services-swiper-horizontal,
  .services-swiper-vertical {
    width: 100%;
    overflow: hidden;
  }

  .swiper-slide {
    width: 100%;
    height: 100%;
  }

  .services-swiper-horizontal {
    width: 100%;
    overflow: hidden;
    padding: 1rem 0 !important;
  }

  .services-swiper-horizontal .swiper-slide {
    width: 100% !important;
    height: auto !important;
  }

  .swiper-pagination {
    position: relative !important;
    bottom: 0 !important;
    margin-top: 1rem;
  }

  .swiper-pagination-bullet {
    width: 8px;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    opacity: 1;
  }

  .swiper-pagination-bullet-active {
    background: rgba(255, 255, 255, 0.8);
  }

  .pagination-bullet-horizontal {
    display: block !important;
    position: relative !important;
  }

  .pagination-bullet-horizontal.active {
    opacity: 1 !important;
    background-color: rgb(255 255 255 / 0.8) !important;
  }
</style>
